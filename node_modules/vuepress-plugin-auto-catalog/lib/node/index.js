import{catalogLocales as u}from"vuepress-plugin-components";import{Logger as f,getTitleFromFilename as h,getLocales as d}from"vuepress-shared/node";import{useSassPalettePlugin as L}from"vuepress-plugin-sass-palette";import{createPage as C}from"@vuepress/core";import{ensureEndingSlash as A}from"@vuepress/shared";import{getDirname as v,path as E}from"@vuepress/utils";const O=v(import.meta.url),T=A(E.resolve(O,"../client")),$=new f("vuepress-plugin-auto-catalog"),P=async(t,{component:o="AutoCatalog",exclude:n=[],frontmatter:p=()=>({}),level:i=3})=>{const{env:{isDebug:s},pages:g}=t,l=new Set,m=`<${o}${[1,2].includes(i)?` :level="${i}"`:""} />
`;g.forEach(({path:a,pathLocale:r})=>{let e=a;for(;e!==r;)e=e.replace(/\/(?:[^/]+\/?)$/,"/"),!l.has(e)&&n.every(c=>!e.match(c))&&g.every(({path:c})=>c!==e)&&(s&&$.info(`Generating catalog ${e}}`),l.add(e))}),await Promise.all(Array.from(l).map(a=>decodeURI(a)).map(a=>{const[,r]=/\/([^/]+)\/?$/.exec(a)||[],e=h(r);return C(t,{frontmatter:{title:e,...p(a)||{}},content:m,path:a})})).then(a=>{t.pages.push(...a)})},S=(t={})=>o=>(L(o,{id:"hope"}),{name:"vuepress-plugin-auto-catalog",define:()=>({CATALOG_LOCALES:d({app:o,name:"catalog",default:u,config:t.locales}),SHOULD_REGISTER_AUTO_CATALOG_COMPONENT:t.component==="AutoCatalog"||!t.component}),onInitialized:async n=>P(n,t),clientConfigFile:`${T}config.js`});export{S as autoCatalogPlugin};
//# sourceMappingURL=index.js.map
