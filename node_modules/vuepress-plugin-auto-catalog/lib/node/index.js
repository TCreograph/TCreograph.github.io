import{Logger as C,getTitleFromFilename as h,getLocales as L}from"vuepress-shared/node";import{useSassPalettePlugin as K}from"vuepress-plugin-sass-palette";import{createPage as M}from"@vuepress/core";import{ensureEndingSlash as y}from"@vuepress/shared";import{getDirname as I,path as x}from"@vuepress/utils";const R=I(import.meta.url),E=new C("vuepress-plugin-auto-catalog"),D=y(x.resolve(R,"../client")),$=async(l,{component:i="AutoCatalog",exclude:u=[],frontmatter:d=()=>({}),level:s=3})=>{const{env:{isDebug:p},pages:r}=l,o=new Set,m=`<${i}${[1,2].includes(s)?` :level="${s}"`:""} />
`;r.forEach(({path:t,pathLocale:g})=>{let e=t;for(;e!==g;)e=e.replace(/\/(?:[^/]+\/?)$/,"/"),!o.has(e)&&u.every(n=>!e.match(n))&&r.every(({path:n})=>n!==e)&&(p&&E.info(`Generating catalog ${e}}`),o.add(e))}),await Promise.all(Array.from(o).map(t=>decodeURI(t)).map(t=>{const[,g]=/\/([^/]+)\/?$/.exec(t)||[],e=h(g);return M(l,{frontmatter:{title:e,...d(t)||{}},content:m,path:t})})).then(t=>{l.pages.push(...t)})},G={"/en/":{title:"Catalog"},"/zh/":{title:"目录"},"/zh-tw/":{title:"目錄"},"/de/":{title:"Katalog"},"/de-at/":{title:"Katalog"},"/vi/":{title:"Danh mục"},"/uk/":{title:"Каталог"},"/ru/":{title:"Каталог"},"/br/":{title:"Catálogo"},"/pl/":{title:"Katalog"},"/sk/":{title:"Katalóg"},"/fr/":{title:"Catalogue"},"/es/":{title:"Catálogo"},"/ja/":{title:"カタログ"},"/tr/":{title:"Katalog"},"/ko/":{title:"목차"},"/fi/":{title:"Luettelo"}},P=(l={})=>i=>{i.env.isDebug&&E.info("Options:",l),K(i,{id:"hope"});const{component:u,exclude:d=[],frontmatter:s=()=>({}),getIcon:p,iconRouteMetaKey:r="i",getIndex:o,indexRouteMetaKey:m="I",level:t=3,locales:g,getOrder:e,orderRouteMetaKey:n="O",getTitle:f,titleRouteMetaKey:A="title"}=l;return{name:"vuepress-plugin-auto-catalog",define:()=>({AUTO_CATALOG_LOCALES:L({app:i,name:"auto-catalog",default:G,config:g}),AUTO_CATALOG_TITLE_META_KEY:A,AUTO_CATALOG_ICON_META_KEY:r,AUTO_CATALOG_ORDER_META_KEY:n,AUTO_CATALOG_INDEX_META_KEY:m}),extendsPage:a=>{if(!u){const c={},T=f==null?void 0:f(a),_=p==null?void 0:p(a),O=e==null?void 0:e(a),v=o==null?void 0:o(a);T&&(c[A]=T),_&&(c[r]=_),v!==!1&&(c[m]=1),O!==null&&(c[n]=O),a.routeMeta={...a.routeMeta,...c}}},onInitialized:async a=>$(a,{exclude:d,frontmatter:s,level:t}),...u?{}:{clientConfigFile:`${D}config.js`}}};export{P as autoCatalogPlugin};
//# sourceMappingURL=index.js.map
