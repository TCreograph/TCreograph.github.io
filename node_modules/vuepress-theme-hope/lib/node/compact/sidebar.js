import { isArray, isPlainObject, isString } from "@vuepress/shared";
import { entries, fromEntries } from "vuepress-shared/node";
import { colors } from "@vuepress/utils";
import { deprecatedLogger, droppedLogger } from "./utils.js";
import { logger } from "../utils.js";
const handleArraySidebarOptions = (config) => config
    .map((item) => {
    if (isString(item))
        return item;
    if (isPlainObject(item)) {
        const convertConfig = [
            ["title", "text"],
            ["path", "link"],
            ["collapsable", "collapsible"],
        ];
        convertConfig.forEach(([deprecatedOption, newOption]) => deprecatedLogger({
            // @ts-ignore
            options: item,
            deprecatedOption,
            newOption,
            scope: "sidebar",
        }));
        // @ts-ignore
        droppedLogger(item, "sidebarDepth", "Found in sidebar");
        if ("children" in item && isArray(item.children))
            handleArraySidebarOptions(item.children);
        return item;
    }
    return null;
})
    .filter((item) => item !== null);
/**
 * @deprecated You should use V2 standard sidebar config and avoid using it
 */
export const convertSidebarOptions = (config) => {
    if (config === false || config === "structure")
        return config;
    if (isArray(config))
        return handleArraySidebarOptions(config);
    if (isPlainObject(config) && config)
        return fromEntries(entries(config).map(([key, value]) => {
            if (isArray(value))
                return [key, handleArraySidebarOptions(value)];
            if (value === "structure" || value === "heading" || value === false)
                return [key, value];
            logger.error('"sidebar" value should be an array, "structure", "heading" or false when setting as an object');
            return [key, false];
        }));
    logger.error(`${colors.magenta("sidebar")} config should be: an array, an object, "structure", "heading" or false`);
    return false;
};
//# sourceMappingURL=sidebar.js.map