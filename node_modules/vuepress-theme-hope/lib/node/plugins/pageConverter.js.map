{"version":3,"file":"pageConverter.js","sourceRoot":"","sources":["../../../src/node/plugins/pageConverter.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,aAAa,EAAE,MAAM,kBAAkB,CAAC;AACjD,OAAO,EAAE,mBAAmB,EAAE,MAAM,sBAAsB,CAAC;AAC3D,OAAO,EAAE,kBAAkB,EAAE,MAAM,qBAAqB,CAAC;AACzD,OAAO,EAAE,gBAAgB,EAAE,MAAM,yBAAyB,CAAC;AAW3D,MAAM,CAAC,MAAM,cAAc,GAAG,CAAC,IAAyB,EAAQ,EAAE;IAChE,MAAM,EAAE,gBAAgB,EAAE,GAAG,IAAI,CAAC;IAClC,MAAM,WAAW,GAAG,IAAI,CAAC,WAGK,CAAC;IAE/B,MAAM,SAAS;IACb,+BAA+B;IAC/B,WAAW,CAAC,OAAO;QACnB,gCAAgC;QAChC,OAAO,CAAC,WAAW,CAAC,OAAO,KAAK,KAAK,IAAI,gBAAgB,CAAC,CAAC;IAC7D,MAAM,OAAO,GAAG,WAAW,CAAC,MAAM,KAAK,OAAO,CAAC;IAE/C,8BAA8B;IAC9B,IAAI,CAAC,SAAS,gCAAsB,GAAG,WAAW,CAAC,IAAI;QACrD,CAAC;QACD,CAAC,CAAC,OAAO;YACT,CAAC;YACD,CAAC,CAAC,SAAS;gBACX,CAAC;gBACD,CAAC,wBAAc,CAAC;IAElB,+DAA+D;IAC/D,IAAI,CAAC,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;IAE9C,IAAI,CAAC,SAAS,iCAAuB,GAAG,IAAI,CAAC,KAAK,CAAC;IAEnD,IAAI,MAAM,IAAI,WAAW;QACvB,IAAI,CAAC,SAAS,gCAAsB,GAAG,WAAW,CAAC,IAAI,CAAC;IAE1D,kBAAkB;IAClB,IAAI,aAAa,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE;QAClC,IAAI,OAAO,IAAI,WAAW,CAAC,GAAG;YAC5B,IAAI,CAAC,SAAS,iCAAuB,GACnC,WACD,CAAC,GAAI,CAAC,KAAK,CAAC;QACf,IACE,OAAO,IAAI,WAAW,CAAC,GAAG;YACzB,WAA0C,CAAC,GAAI,CAAC,KAAK,KAAK,KAAK;YAEhE,IAAI,CAAC,SAAS,iCAAuB,GAAG,CAAC,CAAC;KAC7C;SAAM;QACL,IAAI,OAAO,IAAI,WAAW;YACxB,IAAI,CAAC,SAAS,iCAAuB,GAAG,WAAW,CAAC,KAAK,CAAC;QAC5D,IAAI,OAAO,IAAI,WAAW,IAAI,WAAW,CAAC,KAAK,KAAK,KAAK;YACvD,IAAI,CAAC,SAAS,iCAAuB,GAAG,CAAC,CAAC;KAC7C;IAED,qBAAqB;IACrB,IAAI,YAAY,IAAI,WAAW;QAC7B,IAAI,CAAC,SAAS,sCAA4B,GAAG,WAAW,CAAC,UAAU,CAAC;AACxE,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,iBAAiB,GAAG,CAAC,MAAM,GAAG,IAAI,EAAgB,EAAE,CAAC,CAAC;IACjE,IAAI,EAAE,kCAAkC;IAExC,WAAW,EAAE,CAAC,IAAI,EAAE,GAAG,EAAQ,EAAE;QAC/B,IAAI,MAAM;YACR,IAAI,CAAC,WAAW,GAAG,kBAAkB,CACnC,IAAI,CAAC,WAAW,EAChB,IAAI,CAAC,gBAAgB,IAAI,EAAE,CAC5B,CAAC;QAEJ,gBAAgB,CAAC,IAAI,EAAE,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;QACxC,cAAc,CAAsB,IAAI,CAAC,CAAC;QAC1C,mBAAmB,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;CACF,CAAC,CAAC;AAEH,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAAC,GAAQ,EAAE,MAAM,GAAG,IAAI,EAAQ,EAAE;IACpE,GAAG,CAAC,GAAG,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC,CAAC;AACrC,CAAC,CAAC","sourcesContent":["import { isPlainObject } from \"@vuepress/shared\";\nimport { injectLocalizedDate } from \"vuepress-shared/node\";\nimport { convertFrontmatter } from \"../compact/index.js\";\nimport { checkFrontmatter } from \"../frontmatter/check.js\";\nimport { ArticleInfoType, PageType } from \"../../shared/index.js\";\n\nimport type { App, Page, PluginObject } from \"@vuepress/core\";\nimport type {\n  ThemeBlogHomePageFrontmatter,\n  ThemeNormalPageFrontmatter,\n  ThemePageData,\n  ThemeProjectHomePageFrontmatter,\n} from \"../../shared/index.js\";\n\nexport const injectPageInfo = (page: Page<ThemePageData>): void => {\n  const { filePathRelative } = page;\n  const frontmatter = page.frontmatter as\n    | ThemeProjectHomePageFrontmatter\n    | ThemeBlogHomePageFrontmatter\n    | ThemeNormalPageFrontmatter;\n\n  const isArticle =\n    // declaring this is an article\n    frontmatter.article ||\n    // generated from markdown files\n    Boolean(frontmatter.article !== false && filePathRelative);\n  const isSlide = frontmatter.layout === \"Slide\";\n\n  // save page type to routeMeta\n  page.routeMeta[ArticleInfoType.type] = frontmatter.home\n    ? PageType.home\n    : isSlide\n    ? PageType.slide\n    : isArticle\n    ? PageType.article\n    : PageType.page;\n\n  // save relative file path into page data to generate edit link\n  page.data.filePathRelative = filePathRelative;\n\n  page.routeMeta[ArticleInfoType.title] = page.title;\n\n  if (\"icon\" in frontmatter)\n    page.routeMeta[ArticleInfoType.icon] = frontmatter.icon;\n\n  // catalog related\n  if (isPlainObject(frontmatter.dir)) {\n    if (\"order\" in frontmatter.dir)\n      page.routeMeta[ArticleInfoType.order] = (\n        frontmatter as ThemeNormalPageFrontmatter\n      ).dir!.order;\n    if (\n      \"index\" in frontmatter.dir &&\n      (frontmatter as ThemeNormalPageFrontmatter).dir!.index === false\n    )\n      page.routeMeta[ArticleInfoType.index] = 0;\n  } else {\n    if (\"order\" in frontmatter)\n      page.routeMeta[ArticleInfoType.order] = frontmatter.order;\n    if (\"index\" in frontmatter && frontmatter.index === false)\n      page.routeMeta[ArticleInfoType.index] = 0;\n  }\n\n  // resolve shortTitle\n  if (\"shortTitle\" in frontmatter)\n    page.routeMeta[ArticleInfoType.shortTitle] = frontmatter.shortTitle;\n};\n\nexport const extendsPagePlugin = (legacy = true): PluginObject => ({\n  name: \"vuepress-theme-hope-extends-page\",\n\n  extendsPage: (page, app): void => {\n    if (legacy)\n      page.frontmatter = convertFrontmatter(\n        page.frontmatter,\n        page.filePathRelative || \"\"\n      );\n\n    checkFrontmatter(page, app.env.isDebug);\n    injectPageInfo(<Page<ThemePageData>>page);\n    injectLocalizedDate(page);\n  },\n});\n\nexport const useExtendsPagePlugin = (app: App, legacy = true): void => {\n  app.use(extendsPagePlugin(legacy));\n};\n"]}