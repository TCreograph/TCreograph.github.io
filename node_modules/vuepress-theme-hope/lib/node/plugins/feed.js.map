{"version":3,"file":"feed.js","sourceRoot":"","sources":["../../../src/node/plugins/feed.ts"],"names":[],"mappings":"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","sourcesContent":["import { feedPlugin } from \"vuepress-plugin-feed2\";\nimport {\n  deepAssign,\n  entries,\n  fromEntries,\n  getAuthor,\n  keys,\n} from \"vuepress-shared/node\";\n\nimport type { Plugin } from \"@vuepress/core\";\nimport type { FeedOptions } from \"vuepress-plugin-feed2\";\nimport type { ThemeData } from \"../../shared/index.js\";\nimport { isFunction } from \"@vuepress/shared\";\n\nconst themeComponents = [\n  // @vuepress/plugin-external-link\n  \"ExternalLinkIcon\",\n\n  // vuepress-plugin-auto-catalog\n  \"AutoCatalog\",\n\n  // vuepress-plugin-components\n  \"ArtPlayer\",\n  \"AudioPlayer\",\n  \"Badge\",\n  \"BiliBili\",\n  \"CodePen\",\n  \"FontIcon\",\n  \"PDF\",\n  \"SiteInfo\",\n  \"StackBlitz\",\n  \"VideoPlayer\",\n  \"YouTube\",\n\n  // vuepress-plugin-md-enhance\n  \"ChartJS\",\n  \"CodeDemo\",\n  \"CodeTabs\",\n  \"ECharts\",\n  \"FlowChart\",\n  \"Mermaid\",\n  \"Playground\",\n  \"Presentation\",\n  \"Tabs\",\n  \"VuePlayground\",\n];\n\nexport const getFeedPlugin = (\n  themeData: ThemeData,\n  options: Omit<FeedOptions, \"hostname\"> = {},\n  hostname?: string,\n  favicon?: string,\n  legacy = true\n): Plugin | null => {\n  // disable feed if no options for feed plugin\n  if (!keys(options).length) return null;\n\n  const { removedElements } = options;\n\n  const globalAuthor = getAuthor(themeData.author);\n\n  const defaultOptions: FeedOptions = {\n    // @ts-expect-error\n    hostname,\n    channel: {\n      ...(favicon ? { icon: favicon } : {}),\n      ...(themeData.locales[\"/\"].logo\n        ? {\n            image: themeData.locales[\"/\"].logo,\n          }\n        : {}),\n      ...(globalAuthor.length ? { author: globalAuthor[0] } : {}),\n    },\n    locales: fromEntries(\n      entries(themeData.locales).map(\n        ([localePath, { logo, author, copyright }]) => {\n          const localeAuthor = getAuthor(author);\n\n          return [\n            localePath,\n            {\n              channel: {\n                ...(favicon ? { icon: favicon } : {}),\n                ...(logo ? { image: logo } : {}),\n                ...(localeAuthor.length ? { author: localeAuthor[0] } : {}),\n                ...(typeof copyright === \"string\" ? { copyright } : {}),\n              },\n            },\n          ];\n        }\n      )\n    ),\n  };\n\n  return feedPlugin(\n    deepAssign(defaultOptions, options, {\n      // merge removedElements\n      removedElements: isFunction(removedElements)\n        ? (tagName: string): boolean =>\n            themeComponents.includes(tagName) || removedElements(tagName)\n        : [...themeComponents, ...(removedElements || [])],\n    }),\n    legacy\n  );\n};\n"]}