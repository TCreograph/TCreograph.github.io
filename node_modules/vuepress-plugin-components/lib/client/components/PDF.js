import{ref as v,computed as P,unref as c,onMounted as w,isRef as T,watch as F,defineComponent as C,h as $}from"vue";import{checkIsMobile as D,checkIsSafari as I,useLocaleConfig as x}from"vuepress-shared/client";import{isString as f,isLinkHttp as E,ensureEndingSlash as M}from"@vuepress/shared";import{useEventListener as b}from"@vueuse/core";import{withBase as y}from"@vuepress/client";import"../styles/pdf.scss";const S=e=>f(e)?e:`${e}px`,R=(e,t=0)=>{const n=v(),o=P(()=>S(c(e.width)||"100%")),r=v("auto"),d=s=>{if(f(s)){const[l,u]=s.split(":"),m=Number(l)/Number(u);if(!Number.isNaN(m))return m}return typeof s=="number"?s:16/9},a=s=>{const l=c(e.height),u=d(c(e.ratio));return l?S(l):`${Number(s)/u+c(t)}px`},i=()=>{n.value&&(r.value=a(n.value.clientWidth))};return w(()=>{i(),T(t)&&F(t,()=>i()),b("orientationchange",()=>i()),b("resize",()=>i())}),{el:n,width:o,height:r}},U=e=>E(e)?e:y(e),h=e=>{console.error("[PDF]: "+e)},j=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},z=e=>e==="string"?document.querySelector(e):e instanceof HTMLElement?e:document.body,k=e=>{let t="";return e&&(t+=Object.entries(e).map(([n,o])=>n==="noToolbar"?`toolbar=${o?0:1}`:`${encodeURIComponent(n)}=${encodeURIComponent(o)}`).join("&"),t&&(t="#"+t,t=t.slice(0,t.length-1))),t},L=(e,t,n,o,r)=>{j(t);let d=n;e==="pdfjs"&&(d=`${`${M(y(PDFJS_URL))}web/viewer.html`}?file=${encodeURIComponent(n)}${k(o)}`);const a=e==="pdfjs"||e==="iframe"?"iframe":"embed",i=document.createElement(a);return i.className="pdf-viewer",i.type="application/pdf",i.title=r,i.src=d,i instanceof HTMLIFrameElement&&(i.allow="fullscreen"),t.classList.add("pdf-viewer-container"),t.appendChild(i),t.getElementsByTagName(a)[0]},H=(e,t=null,{title:n,hint:o,options:r={}})=>{var d;if(typeof window>"u"||window.navigator===void 0||window.navigator.userAgent===void 0||window.navigator.mimeTypes===void 0)return null;const a=window.navigator,i=window.navigator.userAgent,s=window.Promise!==void 0,l=a.platform!==void 0&&a.platform==="MacIntel"&&a.maxTouchPoints!==void 0&&a.maxTouchPoints>1||D(i),u=!l&&I(i),m=!l&&/irefox/.test(i)&&i.split("rv:").length>1?parseInt(i.split("rv:")[1].split(".")[0],10)>18:!1,N=!l&&(s||m);if(!f(e))return h("URL is not valid"),null;const p=z(t);if(!p)return h("Target element cannot be determined"),null;const g=n||((d=/\/([^/]+).pdf/.exec(e))==null?void 0:d[1])||"PDF Viewer";return N||!l?L(u?"iframe":"embed",p,e,r,g):PDFJS_URL?L("pdfjs",p,e,r,g):(p.innerHTML=o.replace(/\[url\]/g,e),h("This browser does not support embedded PDFs"),null)};var A=C({name:"PDF",props:{url:{type:String,required:!0},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,zoom:{type:[String,Number],default:100}},setup(e){const{el:t,width:n,height:o}=R(e),r=x(PDF_LOCALES);return w(()=>{H(U(e.url),t.value,{title:e.title,hint:r.value.hint,options:{page:e.page,noToolbar:e.noToolbar,zoom:e.zoom}})}),()=>$("div",{class:"pdf-preview",ref:t,style:{width:n.value,height:o.value}})}});export{A as default};
//# sourceMappingURL=PDF.js.map
