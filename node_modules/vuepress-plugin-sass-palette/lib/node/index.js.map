{"version":3,"file":"index.js","sources":["../../src/node/inject.ts","../../src/node/utils.ts","../../src/node/prepare.ts","../../src/node/plugin.ts","../../src/node/use.ts"],"sourcesContent":["import { isFunction, isString } from \"@vuepress/shared\";\nimport { getBundlerName, mergeViteConfig } from \"vuepress-shared/node\";\n\nimport type { App } from \"@vuepress/core\";\nimport type { ViteBundlerOptions } from \"@vuepress/bundler-vite\";\nimport type {\n  LoaderOptions,\n  WebpackBundlerOptions,\n} from \"@vuepress/bundler-webpack\";\n\ntype LoaderContext = Exclude<\n  LoaderOptions[\"additionalData\"],\n  string | undefined\n> extends (content: string, loaderContext: infer T) => string\n  ? T\n  : never;\n\n/**\n * Use \"additionalData\" to make `${id}-config` available in scss\n *\n * @param config VuePress Bundler config\n * @param app VuePress Node App\n * @param id Module id\n */\nexport const injectConfigModule = (\n  config: unknown,\n  app: App,\n  id: string\n): void => {\n  const bundlerName = getBundlerName(app);\n\n  // for vite\n  if (bundlerName === \"vite\") {\n    const viteBundlerConfig = <ViteBundlerOptions>config;\n\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n    const originalAdditionalData:\n      | string\n      | ((source: string, file: string) => string | Promise<string>)\n      | undefined =\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      viteBundlerConfig.viteOptions?.css?.preprocessorOptions?.[\"scss\"]\n        .additionalData;\n\n    // eslint-disable-next-line\n    viteBundlerConfig.viteOptions = mergeViteConfig(\n      viteBundlerConfig.viteOptions || {},\n      {\n        css: {\n          preprocessorOptions: {\n            scss: {\n              charset: false,\n              additionalData: async (\n                source: string,\n                file: string\n              ): Promise<string> => {\n                const originalContent = isString(originalAdditionalData)\n                  ? `${originalAdditionalData}${source}`\n                  : isFunction(originalAdditionalData)\n                  ? await originalAdditionalData(source, file)\n                  : source;\n\n                return originalContent.match(\n                  new RegExp(`@use\\\\s+[\"']@sass-palette\\\\/${id}-config[\"'];`)\n                )\n                  ? originalContent\n                  : `@use \"@sass-palette/${id}-config\";\\n${originalContent}`;\n              },\n            },\n          },\n        },\n      }\n    );\n  }\n\n  // for webpack\n  else if (bundlerName === \"webpack\") {\n    const webpackBundlerConfig = <WebpackBundlerOptions>config;\n\n    if (!webpackBundlerConfig.scss) webpackBundlerConfig.scss = {};\n\n    const { additionalData } = webpackBundlerConfig.scss;\n\n    const additionalDataHandler = (\n      content: string,\n      loaderContext: LoaderContext\n    ): string => {\n      const originalContent = isString(additionalData)\n        ? `${additionalData}${content}`\n        : isFunction(additionalData)\n        ? additionalData(content, loaderContext)\n        : content;\n\n      return originalContent.match(\n        new RegExp(`@use\\\\s+([\"'])@sass-palette\\\\/${id}-config\\\\1;`)\n      )\n        ? originalContent\n        : `@use \"@sass-palette/${id}-config\";\\n${originalContent}`;\n    };\n\n    webpackBundlerConfig.scss.additionalData = additionalDataHandler;\n  }\n};\n","import { Logger } from \"vuepress-shared/node\";\nimport { fs, getDirname, path } from \"@vuepress/utils\";\n\nconst __dirname = getDirname(import.meta.url);\n\nexport const emptyFile = path.resolve(__dirname, \"../../styles/empty.scss\");\n\nexport const logger = new Logger(\"vuepress-plugin-sass-palette\");\n\nexport const getPath = (path: string): string =>\n  fs.pathExistsSync(path) ? path : emptyFile;\n","import { getPath } from \"./utils.js\";\n\nimport type { App } from \"@vuepress/core\";\n\nexport const prepareConfigFile = (app: App, id: string): Promise<string> =>\n  app.writeTemp(\n    `sass-palette/load-${id}.js`,\n    `\\\nimport \"@sass-palette/${id}-inject\";\nexport default {};\n`\n  );\n\nexport const prepareInjectSass = (app: App, id: string): Promise<string> =>\n  app.writeTemp(\n    `sass-palette/${id}-inject.scss`,\n    `\\\n@use \"sass:color\";\n@use \"sass:list\";\n@use \"sass:math\";\n@use \"sass:map\";\n@use \"sass:meta\";\n\n@use \"@sass-palette/helper\";\n@use \"@sass-palette/${id}-palette\";\n\n$variables: meta.module-variables(\"${id}-palette\");\n${\n  app.env.isDebug\n    ? `\n@debug \"${id} palette variables: #{meta.inspect($variables)}\";\n@debug \"${id} config variables: #{meta.inspect(meta.module-variables(\"${id}-config\"))}\";\n`\n    : \"\"\n}\n\n@each $name, $value in $variables {\n  $key: helper.camel-to-kebab($name);\n\n  @if meta.type-of($value) == number or meta.type-of($value) == string {\n    :root {\n      #{$key}: #{$value};\n    }\n  } @else if helper.color-is-legal($value) {\n    @if meta.global-variable-exists(\"dark-selector\", $module: \"${id}-config\") {\n      @include helper.inject-color($key, $value, $dark-selector: ${id}-config.$dark-selector);\n    } @else {\n      @include helper.inject-color($key, $value);\n    }\n  }\n}\n`\n  );\n\nexport interface PrepareConfigOptions {\n  id: string;\n  defaultConfig: string;\n  defaultPalette: string;\n  generator: string;\n  userConfig: string;\n  userPalette: string;\n}\n\nexport const prepareConfigSass = (\n  app: App,\n  {\n    id,\n    defaultConfig,\n    defaultPalette,\n    generator,\n    userConfig,\n    userPalette,\n  }: PrepareConfigOptions\n): Promise<string> =>\n  app.writeTemp(\n    `sass-palette/${id}-config.scss`,\n    `\\\n@import \"file:///${getPath(defaultPalette)}\";\n@import \"file:///${getPath(defaultConfig)}\";\n@import \"file:///${getPath(userPalette)}\";\n@import \"file:///${getPath(userConfig)}\";\n@import \"file:///${getPath(generator)}\";\n`\n  );\n\nexport interface PreparePaletteOptions {\n  id: string;\n  defaultPalette: string;\n  generator: string;\n  userPalette: string;\n}\n\nexport const preparePaletteSass = (\n  app: App,\n  { id, defaultPalette, generator, userPalette }: PreparePaletteOptions\n): Promise<string> =>\n  app.writeTemp(\n    `sass-palette/${id}-palette.scss`,\n    `\\\n@import \"file:///${getPath(defaultPalette)}\";\n@import \"file:///${getPath(userPalette)}\";\n@import \"file:///${getPath(generator)}\";\n`\n  );\n\nexport interface PrepareStyleOptions {\n  id: string;\n  userStyle: string | null;\n}\n\nexport const prepareStyleSass = (\n  app: App,\n  { id, userStyle }: PrepareStyleOptions\n): Promise<string | null> =>\n  userStyle\n    ? app.writeTemp(\n        `sass-palette/${id}-style.scss`,\n        `\\\n@forward \"file:///${getPath(userStyle)}\";\n`\n      )\n    : Promise.resolve(null);\n","import { getDirname, path } from \"@vuepress/utils\";\nimport { watch } from \"chokidar\";\n\nimport { injectConfigModule } from \"./inject.js\";\nimport {\n  prepareConfigFile,\n  prepareConfigSass,\n  prepareInjectSass,\n  preparePaletteSass,\n  prepareStyleSass,\n} from \"./prepare.js\";\nimport { logger } from \"./utils.js\";\n\nimport type { PluginFunction } from \"@vuepress/core\";\nimport type { SassPaletteOptions } from \"./options.js\";\n\nconst __dirname = getDirname(import.meta.url);\n\nexport const sassPalettePlugin =\n  (options: SassPaletteOptions): PluginFunction =>\n  (app) => {\n    if (app.env.isDebug) logger.info(\"Options:\", options);\n\n    const {\n      id = \"hope\",\n      config = `.vuepress/styles/${id}-config.scss`,\n      defaultConfig = path.resolve(\n        __dirname,\n        \"../../styles/default/config.scss\"\n      ),\n      palette = `.vuepress/styles/${id}-palette.scss`,\n      defaultPalette = path.resolve(\n        __dirname,\n        \"../../styles/default/palette.scss\"\n      ),\n      generator = path.resolve(__dirname, \"../../styles/empty.scss\"),\n      style = \"\",\n    } = options;\n\n    const userConfig = app.dir.source(config);\n    const userPalette = app.dir.source(palette);\n    const userStyle = style ? app.dir.source(style) : null;\n\n    return {\n      name: `vuepress-plugin-sass-palette`,\n\n      multiple: true,\n\n      id,\n\n      alias: {\n        [`@sass-palette/helper`]: path.resolve(\n          __dirname,\n          \"../../styles/helper.scss\"\n        ),\n        [`@sass-palette/${id}-config`]: app.dir.temp(\n          `sass-palette/${id}-config.scss`\n        ),\n        [`@sass-palette/${id}-inject`]: app.dir.temp(\n          `sass-palette/${id}-inject.scss`\n        ),\n        [`@sass-palette/${id}-palette`]: app.dir.temp(\n          `sass-palette/${id}-palette.scss`\n        ),\n        ...(style\n          ? {\n              [`@sass-palette/${id}-style`]: app.dir.temp(\n                `sass-palette/${id}-style.scss`\n              ),\n            }\n          : {}),\n      },\n\n      extendsBundlerOptions: (config: unknown, app): void => {\n        injectConfigModule(config, app, id);\n      },\n\n      onInitialized: (): Promise<void> => {\n        return Promise.all([\n          prepareInjectSass(app, id),\n\n          prepareConfigSass(app, {\n            id,\n            defaultConfig,\n            defaultPalette,\n            generator,\n            userConfig,\n            userPalette,\n          }),\n\n          preparePaletteSass(app, {\n            id,\n            defaultPalette,\n            generator,\n            userPalette,\n          }),\n\n          prepareStyleSass(app, { id, userStyle }),\n        ]).then(() => {\n          if (app.env.isDebug) logger.info(`Style file for ${id} generated`);\n        });\n      },\n\n      onWatched: (app, watchers): void => {\n        const configWatcher = watch(userConfig, {\n          cwd: app.dir.source(),\n          ignoreInitial: true,\n        });\n\n        const updateConfig = (): Promise<void> =>\n          prepareConfigSass(app, {\n            id,\n            defaultConfig,\n            defaultPalette,\n            generator,\n            userConfig,\n            userPalette,\n          }).then(() => {\n            if (app.env.isDebug) logger.info(`Style file for ${id} updated`);\n          });\n\n        configWatcher.on(\"add\", () => {\n          void updateConfig();\n        });\n        configWatcher.on(\"unlink\", () => {\n          void updateConfig();\n        });\n\n        watchers.push(configWatcher);\n\n        const paletteWatcher = watch(userPalette, {\n          cwd: app.dir.source(),\n          ignoreInitial: true,\n        });\n\n        const updatePalette = (): Promise<void> =>\n          Promise.all([\n            prepareConfigSass(app, {\n              id,\n              defaultConfig,\n              defaultPalette,\n              generator,\n              userConfig,\n              userPalette,\n            }),\n\n            preparePaletteSass(app, {\n              id,\n              defaultPalette,\n              generator,\n              userPalette,\n            }),\n          ]).then(() => {\n            if (app.env.isDebug) logger.info(`Style file for ${id} updated`);\n          });\n\n        paletteWatcher.on(\"add\", () => {\n          void updatePalette();\n        });\n        paletteWatcher.on(\"unlink\", () => {\n          void updatePalette();\n        });\n\n        watchers.push(paletteWatcher);\n\n        if (userStyle) {\n          const styleWatcher = watch(userStyle, {\n            cwd: app.dir.source(),\n            ignoreInitial: true,\n          });\n\n          const updateStyle = (): Promise<void> =>\n            prepareStyleSass(app, { id, userStyle }).then(() => {\n              if (app.env.isDebug) logger.info(`Style file for ${id} updated`);\n            });\n\n          styleWatcher.on(\"add\", () => {\n            void updateStyle();\n          });\n          styleWatcher.on(\"unlink\", () => {\n            void updateStyle();\n          });\n          watchers.push(styleWatcher);\n        }\n      },\n\n      clientConfigFile: (app) => prepareConfigFile(app, id),\n    };\n  };\n","import { sassPalettePlugin } from \"./plugin.js\";\n\nimport type { App, PluginObject } from \"@vuepress/core\";\nimport type { SassPaletteOptions } from \"./options.js\";\n\nexport const useSassPalettePlugin = (\n  app: App,\n  options: SassPaletteOptions\n): void => {\n  const { plugins } = app.pluginApi;\n\n  if (\n    plugins\n      .filter<PluginObject & { id: string }>(\n        (plugin): plugin is PluginObject & { id: string } =>\n          plugin.name === `vuepress-plugin-sass-palette`\n      )\n      .every((plugin) => plugin.id !== options.id)\n  )\n    app.use(sassPalettePlugin(options));\n};\n\nexport const removePalettePlugin = (app: App, id: string): void => {\n  const { plugins } = app.pluginApi;\n\n  const index = plugins\n    .filter<PluginObject & { id: string }>(\n      (plugin): plugin is PluginObject & { id: string } =>\n        plugin.name === `vuepress-plugin-sass-palette`\n    )\n    .findIndex((plugin) => plugin.id === id);\n\n  if (index !== -1) app.pluginApi.plugins.splice(index, 1);\n};\n"],"names":["injectConfigModule","config","app","id","_a","_b","_c","bundlerName","getBundlerName","viteBundlerConfig","originalAdditionalData","mergeViteConfig","source","file","originalContent","isString","isFunction","webpackBundlerConfig","additionalData","additionalDataHandler","content","loaderContext","__dirname","getDirname","emptyFile","path","logger","Logger","getPath","fs","prepareConfigFile","prepareInjectSass","prepareConfigSass","defaultConfig","defaultPalette","generator","userConfig","userPalette","preparePaletteSass","prepareStyleSass","userStyle","sassPalettePlugin","options","palette","style","watchers","configWatcher","watch","updateConfig","paletteWatcher","updatePalette","styleWatcher","updateStyle","useSassPalettePlugin","plugins","plugin","removePalettePlugin","index"],"mappings":"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"}